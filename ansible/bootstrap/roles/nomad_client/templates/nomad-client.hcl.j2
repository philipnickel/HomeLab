datacenter = "{{ datacenter }}"
region     = "{{ region }}"
data_dir   = "{{ nomad_client_data_dir }}"
bind_addr  = "0.0.0.0"

advertise {
  http = "{{ tailscale_ip }}"
  rpc  = "{{ tailscale_ip }}"
  serf = "{{ tailscale_ip }}"
}

client {
  enabled   = true
  node_pool = "compute"
  servers   = ["{{ nomad_server_addr }}:4647"]
}

plugin "docker" {
  config {
    allow_privileged = true
    volumes {
      enabled = true
    }
  }
}

plugin "raw_exec" {
  config {
    enabled = true
  }
}
