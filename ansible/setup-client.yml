---
# Setup client: Nomad client only
# Prerequisite: Tailscale configured, server running
#
# Usage: ansible-playbook -i inventory/hosts.yml setup-client.yml

- name: Setup Nomad client
  hosts: clients

  pre_tasks:
    - name: Verify Tailscale is running
      command: tailscale status
      changed_when: false

  roles:
    - nomad_client

  post_tasks:
    - name: Show config location
      debug:
        msg: |
          Config: {{ nomad_config_dir }}/nomad.hcl

          To start: sudo nomad agent -config={{ nomad_config_dir }}/nomad.hcl
